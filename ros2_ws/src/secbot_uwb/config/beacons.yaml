# UWB Beacon Configuration
# This file defines the beacon setup for the UWB positioning system

uwb_positioning_node:
  ros__parameters:
    # Frame IDs
    map_frame: "map"
    odom_frame: "odom"

    # Beacon configuration
    beacons:
      # Beacon 1 (origin)
      10:
        type: "stationary"
        position:
          x: 0.0
          y: 0.0
          z: 0.15  # Height of beacon mount
        known_axes: ["x", "y", "z"]  # All axes known for stationary beacons
        description: "Stationary beacon at origin"

      # Beacon 2: top right corner
      11:
        type: "stationary"
        position:
          x: 3.0
          y: 3.0
          z: 0.15  # Height of beacon mount
        known_axes: ["x", "y", "z"]  # All axes known for stationary beacons
        description: "Stationary beacon at top right corner"

      # Beacon 3: bottom right corner
      13:
        type: "stationary"
        position:
          x: 3.0
          y: 0.0
          z: 0.15
        known_axes: ["x","y","z"]
        description: "stationary beacon at bottom right corner "

    # Tag configuration (devices that are tracked)
    tags:
      # Drone tag
      20:
        description: "Drone UWB tag"
        publish_topic: "/uwb/pose/drone"
        enable_3d_positioning: true  # Enable full 3D positioning for drone

      # Main robot tag
      12:
        description: "Main Robot"
        publish_topic: "/uwb/pose/robot"
        enable_3d_positioning: false

    # Positioning algorithm parameters
    positioning:
      min_beacons_2d: 3  # Minimum beacons for 2D trilateration
      min_beacons_3d: 3  # Minimum beacons for 3D trilateration (this might not work for the drone)
      max_residual: 0.3  # Maximum acceptable residual error (meters)
      outlier_threshold: 1.0  # Distance threshold for outlier rejection (meters)

    # Covariance settings
    covariance:
      base_xy_variance: 0.05  # Base variance for X/Y position (m^2)
      base_z_variance: 100.0   # Base variance for Z position (m^2)
      scale_with_residual: true  # Scale covariance with positioning residual

    # Publishing settings
    publishing:
      rate_hz: 20.0  # Publishing rate for position estimates
      publish_diagnostics: true  # Publish diagnostic information
